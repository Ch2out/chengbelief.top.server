"use strict";(self["webpackChunkmessage_project"]=self["webpackChunkmessage_project"]||[]).push([[169],{6169:function(e,s,t){t.r(s),t.d(s,{default:function(){return d}});var a=function(){var e=this,s=e._self._c;return s("div",[s("div",{staticClass:"flex-box quan"},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[e._v("用户登录")])]),s("div",[s("el-form",{ref:"user",attrs:{rules:e.rules,model:e.user,"label-width":"70px"}},[s("el-form-item",{attrs:{label:"登录名",prop:"username"}},[s("el-input",{attrs:{placeholder:"请输入登录名"},model:{value:e.user.username,callback:function(s){e.$set(e.user,"username",s)},expression:"user.username"}})],1),s("el-form-item",{attrs:{prop:"password",label:"密码"}},[s("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.user.password,callback:function(s){e.$set(e.user,"password",s)},expression:"user.password"}})],1),s("el-form-item",{staticClass:"flex-box",attrs:{"label-width":"0px"}},[s("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("登录")]),s("el-button",{on:{click:e.goReg}},[e._v("注册")]),s("el-button",{attrs:{type:"info"},on:{click:function(s){e.emailPopover=!0}}},[e._v("邮箱找回密码")]),s("el-button",{attrs:{type:"warning"},on:{click:function(s){e.phonePopover=!0}}},[e._v("手机找回密码")])],1)],1)],1)])],1),s("el-dialog",{attrs:{"close-on-click-modal":!1,title:"根据邮箱找回密码",visible:e.emailPopover},on:{"update:visible":function(s){e.emailPopover=s}}},[s("el-form",[s("el-form-item",{attrs:{label:"用户名称"}},[s("el-input",{attrs:{placeholder:"输入您的用户名称"},model:{value:e.emailUser.username,callback:function(s){e.$set(e.emailUser,"username",s)},expression:"emailUser.username"}})],1),s("el-form-item",[s("div",{staticClass:"flex-box"},[e._v(" 邮箱验证码："),s("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"输入用户名后获取邮箱验证码",disabled:e.emailDisabled},model:{value:e.emailUser.code,callback:function(s){e.$set(e.emailUser,"code",s)},expression:"emailUser.code"}}),s("el-button",{attrs:{type:"success"},on:{click:e.sendEmail}},[e._v("发送验证码")])],1)]),s("el-form-item",{attrs:{label:"新密码"}},[s("el-input",{attrs:{placeholder:"输入您的新密码",type:"password",disabled:e.emailDisabled},model:{value:e.emailUser.password,callback:function(s){e.$set(e.emailUser,"password",s)},expression:"emailUser.password"}})],1),s("el-form-item",{staticClass:"flex-box"},[s("el-button",{attrs:{type:"primary"},on:{click:e.updateEmail}},[e._v("确定修改")]),s("el-button",{on:{click:function(s){e.emailPopover=!1}}},[e._v("取 消")])],1)],1)],1),s("el-dialog",{attrs:{"close-on-click-modal":!1,title:"根据手机找回密码",visible:e.phonePopover},on:{"update:visible":function(s){e.phonePopover=s}}},[s("el-form",[s("el-form-item",{attrs:{label:"用户名称"}},[s("el-input",{attrs:{placeholder:"输入您的用户名称"},model:{value:e.phoneUser.username,callback:function(s){e.$set(e.phoneUser,"username",s)},expression:"phoneUser.username"}})],1),s("el-form-item",[s("div",{staticClass:"flex-box",staticStyle:{"justify-content":"space-around"}},[e._v(" 图片验证码："),s("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"图片验证码"},model:{value:e.phoneUser.imageCode,callback:function(s){e.$set(e.phoneUser,"imageCode",s)},expression:"phoneUser.imageCode"}}),s("div",{on:{click:e.createImg}},[s("img",{attrs:{src:e.img}})])],1)]),s("el-form-item",[s("div",{staticClass:"flex-box",staticStyle:{"justify-content":"space-around"}},[e._v(" 手机验证码："),s("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"输入用户名、图片验证码获取",disabled:e.phoneDisabled},model:{value:e.phoneUser.code,callback:function(s){e.$set(e.phoneUser,"code",s)},expression:"phoneUser.code"}}),s("el-button",{attrs:{type:"success"},on:{click:e.sendPhone}},[e._v("发送验证码")])],1)]),s("el-form-item",{attrs:{label:"新密码"}},[s("el-input",{attrs:{placeholder:"输入您的新密码",type:"password",disabled:e.phoneDisabled},model:{value:e.phoneUser.password,callback:function(s){e.$set(e.phoneUser,"password",s)},expression:"phoneUser.password"}})],1),s("el-form-item",{staticClass:"flex-box"},[s("el-button",{attrs:{type:"primary"},on:{click:e.updatePhone}},[e._v("确定修改")]),s("el-button",{on:{click:function(s){e.phonePopover=!1}}},[e._v("取 消")])],1)],1)],1)],1)},o=[],r=(t(7658),t(3685)),l={data(){return{user:{username:"",password:""},rules:{username:[{required:!0,message:"请输入登录名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},emailPopover:!1,emailDisabled:!0,phoneDisabled:!0,phonePopover:!1,emailUser:{username:"",password:"",code:""},phoneUser:{username:"",password:"",code:"",imageCode:""},img:"",formLabelWidth:"120px"}},methods:{submitForm(){let e=JSON.parse(JSON.stringify(this.user));e.password=r.Z.md5(e.password),r.Z.ajax("/user/auth/login",e,(s=>{s.success&&this.$store.dispatch("updatedUser").then((()=>{this.$router.push({path:"/user/main/"+e.username})})),this.resetForm("user")}))},resetForm(e){this.$refs[e].resetFields()},goReg(){this.$router.push("/user/reg")},sendEmail(){r.Z.NoAjax("/tool/sendUserEmailCode",{username:this.emailUser.username},(e=>{e.success?(this.emailDisabled=!1,this.emailPopover=ture,this.$message(e.message)):("验证码长期有效，无需重复发送"==e.message&&(this.emailDisabled=!1,this.emailPopover=!0),this.$message(e.message))}),!0)},sendPhone(){delete this.phoneUser.code,delete this.phoneUser.password,r.Z.NoAjax("/tool/sendUserValidateCode",this.phoneUser,(e=>{e.success?(this.phoneDisabled=!1,this.phonePopover=!0,this.$message(e.message)):("验证码长期有效，无需重复发送"==e.message?(this.phoneDisabled=!1,this.phonePopover=!0):(this.phoneUser.imgCode="",this.createImg()),this.$message(e.message))}),!0)},updateEmail(){let e=JSON.parse(JSON.stringify(this.emailUser));e.password=r.Z.md5(e.password),r.Z.NoAjax("/user/auth/findPwdByEmail",e,(e=>{this.$message(e.message)})),this.emailPopover=!1,this.emailUser={username:"",password:""}},updatePhone(){delete this.phoneUser.imageCode;let e=JSON.parse(JSON.stringify(this.phoneUser));e.password=r.Z.md5(e.password),r.Z.NoAjax("/user/auth/findPwdByPhone",e,(e=>{this.$message(e.message)})),this.phonePopover=!1,this.phoneUser={username:"",password:"",code:"",imageCode:""}},createImg(){r.Z.NoAjax("/tool/getImageCode",{},(e=>{this.img=e.message}))}},created(){this.createImg()}},i=l,n=t(1001),p=(0,n.Z)(i,a,o,!1,null,null,null),d=p.exports}}]);
//# sourceMappingURL=169.09a58d50.js.map